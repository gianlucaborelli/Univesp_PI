<div class="content">
  <div class="title">
    <h1>Orçamentos</h1>
  </div>

  <div class="findBox">
    <div class="findByDate">
      <div>
        <mat-form-field appearance="fill">
          <mat-label>Intervalo de Datas</mat-label>
          <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
            <input
              matStartDate
              formControlName="start"
              placeholder="Data de Inicio"
            />
            <input matEndDate formControlName="end" placeholder="Data Final" />
          </mat-date-range-input>
          <mat-hint>DD/MM/YYYY – DD/MM/YYYY</mat-hint>
          <mat-datepicker-toggle
            matIconSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>

          <mat-error
            *ngIf="range.controls.start.hasError('matStartDateInvalid')"
            >Invalid start date</mat-error
          >
          <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')"
            >Invalid end date</mat-error
          >
        </mat-form-field>
      </div>

      <div>
        <button
          mat-button
          class="find-date-button"
          mat-raised-button
          color="primary"
        >
          Pesquisar por Data
        </button>
      </div>
    </div>
  </div>

  <div class="mat-elevation-z8 content-table">
    <table mat-table multiTemplateDataRows [dataSource]="dataSource">
      <!-- Coluna: Nome do Cliente -->
      <ng-container matColumnDef="cliente">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Cliente</mat-header-cell>
        <mat-cell *matCellDef="let orcamento">{{orcamento.cliente.nome}}</mat-cell>
      </ng-container>

      <!-- Coluna: Valor Total -->
      <ng-container matColumnDef="valorTotal">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Valor Total</mat-header-cell
        >
        <mat-cell *matCellDef="let orcamento">{{
          orcamento.valorTotal
        }}</mat-cell>
      </ng-container>

      <!-- Coluna: Data de Início do Orçamento -->
      <ng-container matColumnDef="dataInicio">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Data Início</mat-header-cell
        >
        <mat-cell *matCellDef="let orcamento">{{
          orcamento.dataInicio
        }}</mat-cell>
      </ng-container>

      <!-- Coluna: Data Final do Orçamento -->
      <ng-container matColumnDef="dataFim">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Data Fim</mat-header-cell
        >
        <mat-cell *matCellDef="let orcamento">{{ orcamento.dataFim }}</mat-cell>
      </ng-container>

      <!-- Coluna: Botão Expandir -->
      <ng-container matColumnDef="expandir">
        <mat-header-cell *matHeaderCellDef></mat-header-cell>
        <mat-cell *matCellDef="let orcamento"></mat-cell>
      </ng-container>

      <!-- Definição das colunas -->
      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>

      <ng-container
        matColumnDef="{{ column }}"
        *ngFor="let column of columnsToDisplay"
      >
        <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
        <td mat-cell *matCellDef="let element">{{ element[column] }}</td>
      </ng-container>
      <ng-container matColumnDef="expand">
        <th mat-header-cell *matHeaderCellDef aria-label="row actions">
          &nbsp;
        </th>
        <td mat-cell *matCellDef="let element">
          <button
            mat-icon-button
            aria-label="expand row"
            (click)="
              expandedElement = expandedElement === element ? null : element;
              $event.stopPropagation()
            "
          >
            <mat-icon *ngIf="expandedElement !== element"
              >keyboard_arrow_down</mat-icon
            >
            <mat-icon *ngIf="expandedElement === element"
              >keyboard_arrow_up</mat-icon
            >
          </button>
        </td>
      </ng-container>

      <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
      <ng-container matColumnDef="expandedDetail">
        <td
          mat-cell
          *matCellDef="let element"
          [attr.colspan]="columnsToDisplayWithExpand.length"
        >
          <div
            class="example-element-detail"
            [@detailExpand]="
              element == expandedElement ? 'expanded' : 'collapsed'
            "
          >
            <div class="example-element-diagram">
              <div class="example-element-position">{{ element.position }}</div>
              <div class="example-element-symbol">{{ element.symbol }}</div>
              <div class="example-element-name">{{ element.name }}</div>
              <div class="example-element-weight">{{ element.weight }}</div>
            </div>
            <div class="example-element-description">
              {{ element.description }}

              <table
                mat-table
                [dataSource]="dataSource"
                class="mat-elevation-z8"
              >
                <!--- Note that these columns can be defined in any order.
                      The actual rendered columns are set as a property on the row definition" -->

                <!-- Position Column -->
                <ng-container matColumnDef="position">
                  <th mat-header-cell *matHeaderCellDef>No.</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.position }}
                  </td>
                </ng-container>

                <!-- Name Column -->
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef>Name</th>
                  <td mat-cell *matCellDef="let element">{{ element.name }}</td>
                </ng-container>

                <!-- Weight Column -->
                <ng-container matColumnDef="weight">
                  <th mat-header-cell *matHeaderCellDef>Weight</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.weight }}
                  </td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="symbol">
                  <th mat-header-cell *matHeaderCellDef>Symbol</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.symbol }}
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumns"
                ></tr>
              </table>

              <span class="example-element-description-attribution">
                -- Wikipedia
              </span>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
      <tr
        mat-row
        *matRowDef="let element; columns: columnsToDisplayWithExpand"
        class="example-element-row"
        [class.example-expanded-row]="expandedElement === element"
        (click)="expandedElement = expandedElement === element ? null : element"
      ></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: ['expandedDetail']"
        class="example-detail-row"
      ></tr>
    </table>
  </div>
</div>
